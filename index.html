<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flag Arena</title>

<style>
body{
  margin:0;
  background:black;
  color:white;
  font-family:Arial;
  overflow:hidden;
}

#title{
  text-align:center;
  font-size:40px;
  margin-top:20px;
  letter-spacing:4px;
}

canvas{
  display:block;
  margin:auto;
  margin-top:20px;
  background:black;
}

#bottomArea{
  position:fixed;
  bottom:0;
  width:100%;
  height:200px;
  background:#111;
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  align-content:flex-start;
  gap:8px;
  padding:10px;
  box-sizing:border-box;
  overflow-y:auto;
}

.eliminated{
  text-align:center;
  font-size:10px;
}

.eliminated img{
  width:30px;
  display:block;
  margin:auto;
}
</style>
</head>

<body>

<div id="title">FLAG ARENA</div>
<canvas id="arena" width="700" height="700"></canvas>
<div id="bottomArea"></div>

<script>

const canvas = document.getElementById("arena");
const ctx = canvas.getContext("2d");

const centerX = canvas.width/2;
const centerY = canvas.height/2;

let radius = 280;
let gapAngle = 0.5;
let shrinkSpeed = 0.05;

let countries = [];
let eliminated = [];

const baseFlags = ["tr","us","de","fr","gb","it","es","br","ar","jp","cn","ru","ca","au","mx"];
while(baseFlags.length < 60){
  baseFlags.push(baseFlags[baseFlags.length % 15]);
}

baseFlags.forEach(code=>{
  countries.push({
    code:code,
    angle:Math.random()*Math.PI*2,
    speed:0.05 + Math.random()*0.03
  });
});

function drawCircle(){
  ctx.beginPath();
  ctx.arc(centerX,centerY,radius,0,Math.PI*2);
  ctx.strokeStyle="white";
  ctx.lineWidth=3;
  ctx.stroke();

  // boşluk
  ctx.beginPath();
  ctx.arc(centerX,centerY,radius,-gapAngle/2,gapAngle/2);
  ctx.strokeStyle="black";
  ctx.lineWidth=6;
  ctx.stroke();
}

function updateBottom(){
  const area = document.getElementById("bottomArea");
  area.innerHTML="";
  eliminated.forEach(c=>{
    const div = document.createElement("div");
    div.className="eliminated";
    div.innerHTML=
      `<img src="https://flagcdn.com/w40/${c.code}.png">
       ${c.code.toUpperCase()}`;
    area.appendChild(div);
  });
}

function animate(){

  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(radius > 180){
    radius -= shrinkSpeed;
  }

  drawCircle();

  let survivors = [];

  for(let c of countries){

    const x = centerX + Math.cos(c.angle)*(radius-25);
    const y = centerY + Math.sin(c.angle)*(radius-25);

    // bayrak çiz
    const img = new Image();
    img.src = `https://flagcdn.com/w40/${c.code}.png`;
    ctx.drawImage(img, x-15, y-10, 30, 20);

    ctx.fillStyle="white";
    ctx.font="10px Arial";
    ctx.textAlign="center";
    ctx.fillText(c.code.toUpperCase(), x, y+18);

    // boşluk kontrol
    if(c.angle > -gapAngle/2 && c.angle < gapAngle/2){
      eliminated.push(c);
      updateBottom();
    } else {
      survivors.push(c);
    }

    c.angle += c.speed;
  }

  countries = survivors;

  if(countries.length > 1){
    requestAnimationFrame(animate);
  }
}

animate();

</script>

</body>
</html>
