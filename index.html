<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flag Arena</title>

<style>
body{
  margin:0;
  background:black;
  color:white;
  font-family:Arial, sans-serif;
  overflow:hidden;
}

#title{
  position:absolute;
  top:20px;
  width:100%;
  text-align:center;
  font-size:40px;
  font-weight:bold;
  letter-spacing:4px;
}

canvas{
  display:block;
  margin:auto;
  margin-top:80px;
  background:black;
}

#eliminatedList{
  position:fixed;
  right:30px;
  top:120px;
  width:220px;
  max-height:75vh;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:6px;
}

.eliminated-item{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:14px;
}

.eliminated-item img{
  width:20px;
  height:14px;
}
</style>
</head>

<body>

<div id="title">FLAG ARENA</div>
<canvas id="arena" width="800" height="800"></canvas>
<div id="eliminatedList"></div>

<script>

const canvas = document.getElementById("arena");
const ctx = canvas.getContext("2d");

const centerX = canvas.width/2;
const centerY = canvas.height/2;

let radius = 320;
let gapAngle = 0.6;
let shrinkSpeed = 0.03;

let countries = [];
let eliminated = [];

// 195 adet oluştur (örnek flag kodları tekrar edebilir, performans için)
const baseFlags = ["tr","us","de","fr","gb","it","es","br","ar","jp","cn","ru","ca","au","mx"];
while(baseFlags.length < 195){
  baseFlags.push(baseFlags[baseFlags.length % 15]);
}

baseFlags.forEach(code=>{
  countries.push({
    code:code,
    angle:Math.random()*Math.PI*2,
    speed:0.04 + Math.random()*0.04 // hız artırıldı
  });
});

function drawCircle(){
  ctx.beginPath();
  ctx.arc(centerX,centerY,radius,0,Math.PI*2);
  ctx.strokeStyle="white";
  ctx.lineWidth=4;
  ctx.stroke();

  // boşluk
  ctx.beginPath();
  ctx.arc(centerX,centerY,radius,-gapAngle/2,gapAngle/2);
  ctx.strokeStyle="black";
  ctx.lineWidth=6;
  ctx.stroke();
}

function updateEliminated(){
  const list = document.getElementById("eliminatedList");
  list.innerHTML="";
  eliminated.slice().reverse().forEach(c=>{
    const div = document.createElement("div");
    div.className="eliminated-item";
    div.innerHTML =
      `<img src="https://flagcdn.com/w40/${c.code}.png">
       ${c.code.toUpperCase()}`;
    list.appendChild(div);
  });
}

function animate(){

  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(radius > 200){
    radius -= shrinkSpeed;
  }

  drawCircle();

  let survivors = [];

  for(let c of countries){

    const x = centerX + Math.cos(c.angle)*(radius-20);
    const y = centerY + Math.sin(c.angle)*(radius-20);

    ctx.beginPath();
    ctx.arc(x,y,8,0,Math.PI*2);
    ctx.fillStyle="white";
    ctx.fill();

    // boşluktan çıkma kontrolü
    if(c.angle > -gapAngle/2 && c.angle < gapAngle/2){
      eliminated.push(c);
    } else {
      survivors.push(c);
    }

    c.angle += c.speed;
  }

  countries = survivors;

  if(eliminated.length > 0){
    updateEliminated();
  }

  if(countries.length > 1){
    requestAnimationFrame(animate);
  }
}

animate();

</script>

</body>
</html>
