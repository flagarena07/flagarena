<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FLAG ARENA</title>
<style>
body{margin:0;background:white;overflow:hidden;font-family:Arial;}
canvas{display:block;}
</style>
</head>
<body>
<canvas id="game"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

const centerX=canvas.width/2;
const centerY=canvas.height/2;

const radius=260;
const wall=20;
const inner=radius-wall;

const segmentCount=180;
const gapSize=20; // segment sayısı

let gapIndex=0;
let flags=[];

function loadFlags(){
flags=[];
for(let i=0;i<60;i++){
let img=new Image();
img.src=`https://flagcdn.com/w80/${["tr","us","de","fr","br","jp","it","es","gb","ca"][i%10]}.png`;
flags.push({
img:img,
x:centerX+(Math.random()-0.5)*100,
y:centerY+(Math.random()-0.5)*100,
vx:(Math.random()-0.5)*3,
vy:(Math.random()-0.5)*3,
r:16
});
}
}

function reflect(f,nx,ny){
let dot=f.vx*nx+f.vy*ny;
f.vx-=2*dot*nx;
f.vy-=2*dot*ny;
}

function update(){
ctx.clearRect(0,0,canvas.width,canvas.height);

gapIndex=(gapIndex+0.5)%segmentCount;

/* DUVAR SEGMENTLERİ */
for(let i=0;i<segmentCount;i++){

if(i>gapIndex && i<gapIndex+gapSize) continue;

let angle=(i/segmentCount)*Math.PI*2;
let nx=Math.cos(angle);
let ny=Math.sin(angle);

ctx.fillStyle="black";
ctx.beginPath();
ctx.arc(centerX+nx*(radius-wall/2),
centerY+ny*(radius-wall/2),
wall/2,0,Math.PI*2);
ctx.fill();
}

/* FİZİK */
flags.forEach(f=>{

f.x+=f.vx;
f.y+=f.vy;

let dx=f.x-centerX;
let dy=f.y-centerY;
let dist=Math.sqrt(dx*dx+dy*dy);

if(dist+f.r>inner){

let angle=Math.atan2(dy,dx);
let index=Math.floor((angle/(Math.PI*2))*segmentCount);
if(index<0) index+=segmentCount;

if(index>gapIndex && index<gapIndex+gapSize){
return;
}

let nx=dx/dist;
let ny=dy/dist;

f.x=centerX+nx*(inner-f.r);
f.y=centerY+ny*(inner-f.r);

reflect(f,nx,ny);
}

ctx.drawImage(f.img,f.x-f.r,f.y-f.r,f.r*2,f.r*2);

});

requestAnimationFrame(update);
}

loadFlags();
update();
</script>
</body>
</html>
