<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FLAG ARENA</title>
<style>
body {
    margin:0;
    background:#ffffff;
    overflow:hidden;
    font-family:Arial, sans-serif;
}
canvas { display:block; }

#winsBoard {
    position:absolute;
    top:20px;
    right:20px;
    width:200px;
    font-size:14px;
}
#winsBoard h3 {
    margin:0 0 10px 0;
}
#winsList div {
    margin-bottom:4px;
}

#countdown {
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:80px;
    font-weight:bold;
}

#title {
    position:absolute;
    top:40%;
    left:50%;
    transform:translateX(-50%);
    font-size:50px;
    opacity:0.08;
}
</style>
</head>
<body>

<div id="title">FLAG ARENA</div>
<div id="countdown"></div>

<div id="winsBoard">
    <h3>Top Wins</h3>
    <div id="winsList"></div>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const centerX = canvas.width/2;
const centerY = canvas.height/2 - 50;
const arenaRadius = 250;
const gapSize = Math.PI / 6;

let gapAngle = 0;
let flags = [];
let eliminated = [];
let wins = {};
let gameActive = false;

const flagList = ["ðŸ‡¹ðŸ‡·","ðŸ‡ºðŸ‡¸","ðŸ‡©ðŸ‡ª","ðŸ‡«ðŸ‡·","ðŸ‡§ðŸ‡·","ðŸ‡¯ðŸ‡µ","ðŸ‡®ðŸ‡¹","ðŸ‡ªðŸ‡¸"];

function loadFlags() {
    flags = [];
    flagList.forEach(flag=>{
        flags.push({
            symbol: flag,
            x: centerX + (Math.random()-0.5)*100,
            y: centerY + (Math.random()-0.5)*100,
            vx: (Math.random()-0.5)*6,
            vy: (Math.random()-0.5)*6,
            radius: 25
        });
    });
}

function startCountdown() {
    let count = 3;
    const cd = document.getElementById("countdown");
    cd.innerText = count;
    const interval = setInterval(()=>{
        count--;
        if(count >= 0) {
            cd.innerText = count;
        }
        if(count < 0) {
            clearInterval(interval);
            cd.innerText = "";
            gameActive = true;
        }
    },1000);
}

function update() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    gapAngle += 0.02;

    // Arena
    ctx.beginPath();
    ctx.arc(centerX, centerY, arenaRadius, 0, Math.PI*2);
    ctx.stroke();

    // Gap
    ctx.beginPath();
    ctx.arc(centerX, centerY, arenaRadius, gapAngle, gapAngle+gapSize);
    ctx.strokeStyle="red";
    ctx.lineWidth=5;
    ctx.stroke();
    ctx.strokeStyle="black";
    ctx.lineWidth=1;

    if(gameActive) {
        flags.forEach(f=>{
            f.x += f.vx;
            f.y += f.vy;

            const dx = f.x - centerX;
            const dy = f.y - centerY;
            const dist = Math.sqrt(dx*dx + dy*dy);

            if(dist + f.radius > arenaRadius) {
                const angle = Math.atan2(dy,dx);
                let diff = angle - gapAngle;
                diff = (diff + Math.PI*2) % (Math.PI*2);

                if(diff > gapSize) {
                    // bounce
                    const nx = dx/dist;
                    const ny = dy/dist;
                    const dot = f.vx*nx + f.vy*ny;
                    f.vx -= 2*dot*nx;
                    f.vy -= 2*dot*ny;
                } else {
                    eliminated.push(f);
                }
            }
        });

        flags = flags.filter(f=>!eliminated.includes(f));

        if(flags.length === 1) {
            const winner = flags[0];
            wins[winner.symbol] = (wins[winner.symbol]||0)+1;
            updateWins();
            gameActive = false;
            setTimeout(resetGame,2000);
        }
    }

    // Draw flags
    ctx.font = "40px Arial";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    flags.forEach(f=>{
        ctx.fillText(f.symbol,f.x,f.y);
    });

    drawEliminated();
    requestAnimationFrame(update);
}

function drawEliminated() {
    const startY = canvas.height - 80;
    ctx.font = "30px Arial";
    eliminated.forEach((f,i)=>{
        ctx.fillText(f.symbol,50 + i*40,startY);
    });
}

function updateWins() {
    const list = document.getElementById("winsList");
    list.innerHTML = "";
    const sorted = Object.entries(wins).sort((a,b)=>b[1]-a[1]).slice(0,10);
    sorted.forEach(entry=>{
        const div = document.createElement("div");
        div.innerText = entry[0] + " - " + entry[1];
        list.appendChild(div);
    });
}

function resetGame() {
    eliminated = [];
    loadFlags();
    startCountdown();
}

loadFlags();
startCountdown();
update();
</script>

</body>
</html>
